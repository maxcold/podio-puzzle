(function(e){function a(n,r,s){var o=!1;if(i){var a=[];e.each(u,function(){s.hasOwnProperty(this)&&(o=!0)&&a.push({name:this,val:s[this]})}),o&&(e.each(s,function(e){a.push({name:e,val:this})}),s=a)}e.each(s,function(i,s){o&&(i=s.name,s=s.val);if(e.isFunction(s)&&(!t||s.toString().indexOf(".__base")>-1)){var u=n[i]||function(){};r[i]=function(){var e=this.__base;this.__base=u;var t=s.apply(this,arguments);return this.__base=e,t}}else r[i]=s})}var t=function(){_}.toString().indexOf("_")>-1,n=function(){},r=Object.create||function(e){var t=function(){};return t.prototype=e,new t},i=!0,s={toString:""};for(var o in s)s.hasOwnProperty(o)&&(i=!1);var u=i?["toString","valueOf"]:null;e.inherit=function(){var t=arguments,i=e.isFunction(t[0]),s=i?t[0]:n,o=t[i?1:0]||{},u=t[i?2:1],f=o.__constructor||i&&s.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:function(){};if(!i)return f.prototype=o,f.prototype.__self=f.prototype.constructor=f,e.extend(f,u);e.extend(f,s);var l=s.prototype,c=f.prototype=r(l);return c.__self=c.constructor=f,a(l,c,o),u&&a(s,f,u),f},e.inheritSelf=function(e,t,n){var r=e.prototype;return a(r,r,t),n&&a(e,e,n),e}})(jQuery),function(e){var t=0,n="__"+ +(new Date),r=function(){return"uniq"+ ++t};e.identify=function(e,t){if(!e)return r();var i="uniqueID"in e?"uniqueID":n;return t||i in e?e[i]:e[i]=r()}}(jQuery),function(e){e.isEmptyObject||(e.isEmptyObject=function(e){for(var t in e)return!1;return!0})}(jQuery),function(e){e.extend({debounce:function(e,t,n,r){arguments.length==3&&typeof n!="boolean"&&(r=n,n=!1);var i;return function(){var s=arguments;r=r||this,n&&!i&&e.apply(r,s),clearTimeout(i),i=setTimeout(function(){n||e.apply(r,s),i=null},t)}},throttle:function(e,t,n){var r,i,s;return function(){i=arguments,s=!0,n=n||this,r||function(){s?(e.apply(n,i),s=!1,r=setTimeout(arguments.callee,t)):r=null}()}}})}(jQuery),function(e){var t="__"+ +(new Date)+"storage",n=function(t,n){return e.identify(t)+(n?e.identify(n):"")},r={buildEventName:function(e){return e},on:function(r,i,s,o,u){if(typeof r=="string"){e.isFunction(i)&&(o=s,s=i,i=undefined);var a=n(s,o),f=this[t]||(this[t]={}),l=r.split(" "),c=0,h;while(r=l[c++]){r=this.buildEventName(r),h=f[r]||(f[r]={ids:{},list:{}});if(!(a in h.ids)){var p=h.list,d={fn:s,data:i,ctx:o,special:u};p.last?(p.last.next=d,d.prev=p.last):p.first=d,h.ids[a]=p.last=d}}}else{var v=this;e.each(r,function(e,t){v.on(e,t,i,u)})}return this},onFirst:function(e,t,n,r){return this.on(e,t,n,r,{one:!0})},un:function(r,i,s){if(typeof r=="string"||typeof r=="undefined"){var o=this[t];if(o)if(r){var u=r.split(" "),a=0,f;while(r=u[a++]){r=this.buildEventName(r);if(f=o[r])if(i){var l=n(i,s),c=f.ids;if(l in c){var h=f.list,p=c[l],d=p.prev,v=p.next;d?d.next=v:p===h.first&&(h.first=v),v?v.prev=d:p===h.last&&(h.last=d),delete c[l]}}else delete this[t][r]}}else delete this[t]}else{var m=this;e.each(r,function(e,t){m.un(e,t,s)})}return this},trigger:function(n,r){var i=this,s=i[t],o;typeof n=="string"?n=e.Event(i.buildEventName(o=n)):n.type=i.buildEventName(o=n.type),n.target||(n.target=i);if(s&&(s=s[n.type])){var u=s.list.first,a;while(u)n.data=u.data,a=u.fn.call(u.ctx||i,n,r),typeof a!="undefined"&&(n.result=a,a===!1&&(n.preventDefault(),n.stopPropagation())),u.special&&u.special.one&&i.un(o,u.fn,u.ctx),u=u.next}return this}};e.observable=e.inherit(r,r)}(jQuery),function(e,t){function s(e,t,n){return(e?"__elem_"+e:"")+"__mod"+(t?"_"+t:"")+(n?"_"+n:"")}function o(t,n,r){e.isFunction(t)?n[s(r,"*","*")]=t:e.each(t,function(t,i){e.isFunction(i)?n[s(r,t,"*")]=i:e.each(i,function(e,i){n[s(r,t,e)]=i})})}function u(e,t){return t?Array.isArray(t)?function(n){var r=0,i=t.length;while(r<i)if(n.hasMod(e,t[r++]))return!0;return!1}:function(n){return n.hasMod(e,t)}:function(t){return t.hasMod(e)}}var n=[],r={},i={};this.BEM=e.inherit(e.observable,{__constructor:function(e,t,n){var r=this;r._modCache=e||{},r._processingMods={},r._params=t,r.params=null,n!==!1?r._init():r.afterCurrentEvent(function(){r._init()})},_init:function(){return!this._initing&&!this.hasMod("js","inited")&&(this._initing=!0,this.params||(this.params=e.extend(this.getDefaultParams(),this._params),delete this._params),this.setMod("js","inited"),delete this._initing,this.hasMod("js","inited")&&this.trigger("init")),this},changeThis:function(e,t){return e.bind(t||this)},afterCurrentEvent:function(e,t){this.__self.afterCurrentEvent(this.changeThis(e,t))},trigger:function(e,t){return this.__base(e=this.buildEvent(e),t).__self.trigger(e,t),this},buildEvent:function(t){return typeof t=="string"&&(t=e.Event(t)),t.block=this,t},hasMod:function(e,n,r){var i=arguments.length,s=!1;i==1?(r="",n=e,e=t,s=!0):i==2&&(typeof e=="string"?(r=n,n=e,e=t):(r="",s=!0));var o=this.getMod(e,n)===r;return s?!o:o},getMod:function(e,t){var n=typeof e;if(n==="string"||n==="undefined"){t=e||t;var r=this._modCache;return t in r?r[t]:r[t]=this._extractModVal(t)}return this._getElemMod(t,e)},_getElemMod:function(e,t,n){return this._extractModVal(e,t,n)},getMods:function(e){var n=e&&typeof e!="string",r=this,i=[].slice.call(arguments,n?1:0),s=r._extractMods(i,n?e:t);return n||(i.length?i.forEach(function(e){r._modCache[e]=s[e]}):r._modCache=s),s},setMod:function(n,r,i){typeof i=="undefined"&&(i=r,r=n,n=t);var s=this;if(!n||n[0]){var o=(n&&n[0]?e.identify(n[0]):"")+"_"+r;if(this._processingMods[o])return s;var u,a=n?s._getElemMod(r,n,u=s.__self._extractElemNameFrom(n)):s.getMod(r);if(a===i)return s;this._processingMods[o]=!0;var f=!0,l=[r,i,a];n&&l.unshift(n),[["*","*"],[r,"*"],[r,i]].forEach(function(e){f=s._callModFn(u,e[0],e[1],l)!==!1&&f}),!n&&f&&(s._modCache[r]=i),f&&s._afterSetMod(r,i,a,n,u),delete this._processingMods[o]}return s},_afterSetMod:function(e,t,n,r,i){},toggleMod:function(e,n,r,i,s){typeof e=="string"&&(s=i,i=r,r=n,n=e,e=t),typeof i=="undefined"?i="":typeof i=="boolean"&&(s=i,i="");var o=this.getMod(e,n);return(o==r||o==i)&&this.setMod(e,n,typeof s=="boolean"?s?r:i:this.hasMod(e,n,r)?i:r),this},delMod:function(e,n){return n||(n=e,e=t),this.setMod(e,n,"")},_callModFn:function(e,n,r,i){var o=s(e,n,r);return this[o]?this[o].apply(this,i):t},_extractModVal:function(e,t){return""},_extractMods:function(e,t){return{}},channel:function(e,t){return this.__self.channel(e,t)},getDefaultParams:function(){return{}},del:function(e){var t=[].slice.call(arguments);return typeof e=="string"&&t.unshift(this),this.__self.del.apply(this.__self,t),this},destruct:function(){}},{_name:"i-bem",blocks:r,decl:function(n,i,s){typeof n=="string"?n={block:n}:n.name&&(n.block=n.name);if(n.baseBlock&&!r[n.baseBlock])throw'baseBlock "'+n.baseBlock+'" for "'+n.block+'" is undefined';i||(i={}),i.onSetMod&&(o(i.onSetMod,i),delete i.onSetMod),i.onElemSetMod&&(e.each(i.onElemSetMod,function(e,t){o(t,i,e)}),delete i.onElemSetMod);var a=r[n.baseBlock||n.block]||this;if(n.modName){var f=u(n.modName,n.modVal);e.each(i,function(n,r){e.isFunction(r)&&(i[n]=function(){var e;if(f(this))e=r;else{var s=a.prototype[n];s&&s!==i[n]&&(e=this.__base)}return e?e.apply(this,arguments):t})})}if(s&&typeof s.live=="boolean"){var l=s.live;s.live=function(){return l}}var c;return n.block==a._name?(c=e.inheritSelf(a,i,s))._processLive(!0):(c=r[n.block]=e.inherit(a,i,s))._name=n.block,c},_processLive:function(e){return!1},create:function(e,t){return typeof e=="string"&&(e={block:e}),new r[e.block](e.mods,t)},getName:function(){return this._name},_extractElemNameFrom:function(e){},afterCurrentEvent:function(e,t){n.push({fn:e,ctx:t})==1&&setTimeout(this._runAfterCurrentEventFns,0)},_runAfterCurrentEventFns:function(){var e=n.length;if(e){var t,r=n.splice(0,e);while(t=r.shift())t.fn.call(t.ctx||this)}},changeThis:function(e,t){return e.bind(t||this)},del:function(e){var t=typeof e=="string",n=t?0:1,r=arguments.length;t&&(e=this);while(n<r)delete e[arguments[n++]];return this},channel:function(n,r){typeof n=="boolean"&&(r=n,n=t),n||(n="default");if(r){i[n]&&(i[n].un(),delete i[n]);return}return i[n]||(i[n]=new e.observable)}})}(jQuery),function(){Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t})}(),function(){var e=Array.prototype,t=Object.prototype.toString,n={indexOf:function(e,t){t=+(t||0);var n=this,r=n.length;if(r>0&&t<r){t=t<0?Math.ceil(t):Math.floor(t),t<-r&&(t=0),t<0&&(t+=r);while(t<r){if(t in n&&n[t]===e)return t;++t}}return-1},forEach:function(e,t){var n=-1,r=this,i=r.length;while(++n<i)n in r&&(t?e.call(t,r[n],n,r):e(r[n],n,r))},map:function(e,t){var n=-1,r=this,i=r.length,s=new Array(i);while(++n<i)n in r&&(s[n]=t?e.call(t,r[n],n,r):e(r[n],n,r));return s},filter:function(e,t){var n=-1,r=this,i=r.length,s=[];while(++n<i)n in r&&(t?e.call(t,r[n],n,r):e(r[n],n,r))&&s.push(r[n]);return s},reduce:function(e,t){var n=-1,r=this,i=r.length,s;if(arguments.length<2){while(++n<i)if(n in r){s=r[n];break}}else s=t;while(++n<i)n in r&&(s=e(s,r[n],n,r));return s},some:function(e,t){var n=-1,r=this,i=r.length;while(++n<i)if(n in r&&(t?e.call(t,r[n],n,r):e(r[n],n,r)))return!0;return!1},every:function(e,t){var n=-1,r=this,i=r.length;while(++n<i)if(n in r&&(t?!e.call(t,r[n],n,r):!e(r[n],n,r)))return!1;return!0}};for(var r in n)e[r]||(e[r]=n[r]);Array.isArray||(Array.isArray=function(e){return t.call(e)==="[object Array]"})}(),function(){var e=Array.prototype.slice;Function.prototype.bind||(Function.prototype.bind=function(t){var n=this,r=e.call(arguments,1);return function(){return n.apply(t,r.concat(e.call(arguments)))}})}(),function(e,t,n){function o(e,t,n){n.push(r,e,r,t)}function u(e,t,n,r){r.push(e),n&&o(t,n,r)}function a(e,t,r,s,a){u(e,n,n,a),a.push(i,t),s&&o(r,s,a)}var r="_",i="__",s="[a-zA-Z0-9-]+";e.INTERNAL={NAME_PATTERN:s,MOD_DELIM:r,ELEM_DELIM:i,buildModPostfix:function(e,t,n){var r=n||[];return o(e,t,r),n?r:r.join("")},buildClass:function(e,t,r,i,s){var o=typeof r;o=="string"?typeof i!="string"&&(s=i,i=r,r=t,t=n):o!="undefined"?(s=r,r=n):t&&typeof t!="string"&&(s=t,t=n);if(!(t||r||s))return e;var f=s||[];return t?a(e,t,r,i,f):u(e,r,i,f),s?f:f.join("")},buildClasses:function(e,r,i,s){r&&typeof r!="string"&&(s=i,i=r,r=n);var o=s||[];return r?a(e,r,n,n,o):u(e,n,n,o),i&&t.each(i,function(t,n){n&&(o.push(" "),r?a(e,r,t,n,o):u(e,t,n,o))}),s?o:o.join("")}}}(BEM,jQuery),function(e,t,n){function g(e,n){var r=e[0];t.each(E(r),function(i,s){b(s,r,i,n);var u=o[s.uniqId];u?u.domElem.index(r)<0&&(u.domElem=u.domElem.add(e),t.extend(u._params,s)):y(i,e,s)})}function y(e,r,i,u,a){typeof i=="boolean"&&(a=u,u=i,i=n);var f=r[0];i=b(i||E(f)[e],f,e);var c=i.uniqId;if(o[c])return o[c]._init();s[c]=s[c]?s[c].add(r):r;var h=f.parentNode;(!h||h.nodeType===11)&&t.unique(s[c]);var p=l[e]||C.decl(e,{},{live:!0});if(!(p._liveInitable=!!p._processLive())||u||i.live===!1){var d=new p(s[c],i,!!u);return delete s[c],a&&a.apply(d,Array.prototype.slice.call(arguments,4)),d}}function b(e,n,r,i){(e||(e={})).uniqId||(e.uniqId=(e.id?r+"-id-"+e.id:t.identify())+(i||t.identify()));var s=t.identify(n),o=u[s]||(u[s]={});return o[r]||(o[r]=e),e}function w(e,t,n){var r=e.find(t);return n?r:r.add(e.filter(t))}function E(e){var n=t.identify(e);return u[n]||(u[n]=S(e))}function S(e){var n=e.onclick||e.ondblclick;if(!n&&e.tagName.toLowerCase()=="body"){var r=t(e),i=r.attr("onclick")||r.attr("ondblclick");i&&(n=Function(i))}return n?n():{}}function x(e){delete u[t.identify(e)]}function T(e,t){e.domElem.length===1?e.destruct(!0):e.domElem=e.domElem.not(t)}function N(){return i[0][t.support.boxModel?"documentElement":"body"]}var r=t(window),i=t(document),s={},o={},u={},a={},f={},l=e.blocks,c=e.INTERNAL,h=c.NAME_PATTERN,p=c.MOD_DELIM,d=c.ELEM_DELIM,v=c.buildModPostfix,m=c.buildClass;t.fn.bem=function(e,t){return y(e,this,t,!0)};var C=e.DOM=e.decl("i-bem__dom",{__constructor:function(e,n,r){var i=this;i.domElem=e,i._eventNameCache={},i._elemCache={},o[i._uniqId=n.uniqId||t.identify(i)]=i,i._needSpecialUnbind=!1,i.__base(null,n,r)},findBlocksInside:function(e,t){return this._findBlocks("find",e,t)},findBlockInside:function(e,t){return this._findBlocks("find",e,t,!0)},findBlocksOutside:function(e,t){return this._findBlocks("parents",e,t)},findBlockOutside:function(e,t){return this._findBlocks("closest",e,t)[0]||null},findBlocksOn:function(e,t){return this._findBlocks("",e,t)},findBlockOn:function(e,t){return this._findBlocks("",e,t,!0)},_findBlocks:function(e,r,i,s){i||(i=r,r=n);var o=r?typeof r=="string"?this.findElem(r):r:this.domElem,u=typeof i=="string",a=u?i:i.block||i.blockName,f="."+(u?m(a):m(a,i.modName,i.modVal))+(s?":first":""),l=o.filter(f);e&&(l=l.add(o[e](f)));if(s)return l[0]?y(a,l.eq(0),!0):null;var c=[],h={};return t.each(l,function(e,n){var r=y(a,t(n),!0);h[r._uniqId]||(h[r._uniqId]=!0,c.push(r))}),c},bindToDomElem:function(e,n,r){var i=this;return r?e.bind(i._buildEventName(n),function(e){return(e.data||(e.data={})).domElem=t(this),r.apply(i,arguments)}):t.each(n,function(t,n){i.bindToDomElem(e,t,n)}),i},bindToDoc:function(e,t){return this._needSpecialUnbind=!0,this.bindToDomElem(i,e,t)},bindToWin:function(e,t){return this._needSpecialUnbind=!0,this.bindToDomElem(r,e,t)},bindTo:function(e,n,r){return!n||t.isFunction(n)?(r=n,n=e,e=this.domElem):typeof e=="string"&&(e=this.elem(e)),this.bindToDomElem(e,n,r)},unbindFromDomElem:function(e,t){return e.unbind(this._buildEventName(t)),this},unbindFromDoc:function(e){return this.unbindFromDomElem(i,e)},unbindFromWin:function(e){return this.unbindFromDomElem(r,e)},unbindFrom:function(e,t){return t?typeof e=="string"&&(e=this.elem(e)):(t=e,e=this.domElem),this.unbindFromDomElem(e,t)},_buildEventName:function(e){var t=this;return e.indexOf(" ")>1?e.split(" ").map(function(e){return t._buildOneEventName(e)}).join(" "):t._buildOneEventName(e)},_buildOneEventName:function(e){var t=this,n=t._eventNameCache;if(e in n)return n[e];var r="."+t._uniqId;if(e.indexOf(".")<0)return n[e]=e+r;var i=".bem_"+t.__self._name;return n[e]=e.split(".").map(function(e,t){return t==0?e+i:i+"_"+e}).join("")+r},trigger:function(e,t){return this.__base(e=this.buildEvent(e),t).domElem&&this._ctxTrigger(e,t),this},_ctxTrigger:function(e,n){var r=this,i=a[r.__self._buildCtxEventName(e.type)],s={};i&&r.domElem.each(function(){var o=this,u=i.counter;while(o&&u){var a=t.identify(o,!0);if(a){if(s[a])break;var f=i.ctxs[a];f&&(t.each(f,function(t,i){i.fn.call(i.ctx||r,e,n)}),u--),s[a]=!0}o=o.parentNode}})},setMod:function(e,n,r){if(e&&typeof r!="undefined"&&e.length>1){var i=this;return e.each(function(){var s=t(this);s.__bemElemName=e.__bemElemName,i.setMod(s,n,r)}),i}return this.__base(e,n,r)},_extractModVal:function(e,t,n){var r=(t||this.domElem)[0],i;return r&&(i=r.className.match(this.__self._buildModValRE(e,n||t))),i?i[2]:""},_extractMods:function(e,t){var n={},r=!e.length,i=0;return((t||this.domElem)[0].className.match(this.__self._buildModValRE("("+(r?h:e.join("|"))+")",t,"g"))||[]).forEach(function(e){var t=(e=e.trim()).lastIndexOf(p),r=e.substr(0,t-1).lastIndexOf(p);n[e.substr(r+1,t-r-1)]=e.substr(t+1),++i}),i<e.length&&e.forEach(function(e){e in n||(n[e]="")}),n},_afterSetMod:function(e,n,r,i,s){var o=this.__self,u=o._buildModClassPrefix(e,s),a=o._buildModValRE(e,s),f=n==="";(i||this.domElem).each(function(){var e=this.className;e.indexOf(u)>-1?this.className=e.replace(a,(f?"":"$1"+u+n)+"$3"):f||t(this).addClass(u+n)}),s&&this.dropElemCache(s,e,r).dropElemCache(s,e,n)},findElem:function(e,t,n,r){arguments.length%2?(r=n,n=t,t=e,e=this.domElem):typeof e=="string"&&(e=this.findElem(e));var i=this.__self,s="."+t.split(" ").map(function(e){return m(i._name,e,n,r)}).join(",.");return w(e,s)},_elem:function(e,t,n){var r=e+v(t,n),i;return(i=this._elemCache[r])||(i=this._elemCache[r]=this.findElem(e,t,n),i.__bemElemName=e),i},elem:function(e,n,r){if(n&&typeof n!="string")return n.__bemElemName=e,n;if(e.indexOf(" ")<0)return this._elem(e,n,r);var i=t([]),s=this;return e.split(" ").forEach(function(e){i=i.add(s._elem(e,n,r))}),i},dropElemCache:function(e,t,n){if(e){var r=this,i=v(t,n);e.indexOf(" ")<0?delete r._elemCache[e+i]:e.split(" ").forEach(function(e){delete r._elemCache[e+i]})}else this._elemCache={};return this},elemParams:function(e){var t;return typeof e=="string"?(t=e,e=this.elem(e)):t=this.__self._extractElemNameFrom(e),S(e[0])[m(this.__self.getName(),t)]||{}},containsDomElem:function(e){var t=!1;return this.domElem.each(function(){return!(t=e.parents().andSelf().index(this)>-1)}),t},buildSelector:function(e,t,n){return this.__self.buildSelector(e,t,n)},destruct:function(e){var n=this,r=n.__self;n._isDestructing=!0,n._needSpecialUnbind&&r.doc.add(r.win).unbind("."+n._uniqId),n.dropElemCache().domElem.each(function(e,n){var r=E(n);t.each(r,function(e,t){var i=o[t.uniqId];i?i._isDestructing||(T(i,n),delete r[e]):delete s[t.uniqId]}),t.isEmptyObject(r)&&x(n)}),e||n.domElem.remove(),delete o[n.un()._uniqId],delete n.domElem,delete n._elemCache,n.__base()}},{doc:i,win:r,_processLive:function(e){var t=this,n=t._liveInitable;if("live"in t){var r=typeof n=="undefined";r^e&&(n=t.live()!==!1,t.live=function(){})}return n},init:function(e,n,r){if(!e||t.isFunction(e))r=n,n=e,e=i;var s=t.identify();return w(e,".i-bem").each(function(){g(t(this),s)}),n&&this.afterCurrentEvent(function(){n.call(r||this,e)}),this._runAfterCurrentEventFns(),e},destruct:function(e,r,i){typeof e!="boolean"&&(i=r,r=e,e=n),w(r,".i-bem",i).each(function(e,n){var r=E(this);t.each(r,function(e,t){if(t.uniqId){var i=o[t.uniqId];i?(T(i,n),delete r[e]):delete s[t.uniqId]}}),t.isEmptyObject(r)&&x(this)}),e||(i?r.empty():r.remove())},update:function(e,t,n,r){this.destruct(e,!0),this.init(e.html(t),n,r)},replace:function(e,n){this.destruct(!0,e),this.init(t(n).replaceAll(e))},append:function(e,n){this.init(t(n).appendTo(e))},prepend:function(e,n){this.init(t(n).prependTo(e))},before:function(e,n){this.init(t(n).insertBefore(e))},after:function(e,n){this.init(t(n).insertAfter(e))},_buildCtxEventName:function(e){return this._name+":"+e},_liveClassBind:function(e,n,r,s){var o=this;if(n.indexOf(" ")>-1)n.split(" ").forEach(function(t){o._liveClassBind(e,t,r,s)});else{var u=f[n],a=t.identify(r);u||(u=f[n]={},i.bind(n,o.changeThis(o._liveClassTrigger,o))),u=u[e]||(u[e]={uniqIds:{},fns:[]}),a in u.uniqIds||(u.fns.push({uniqId:a,fn:o._buildLiveEventFn(r,s)}),u.uniqIds[a]=u.fns.length-1)}return this},_liveClassUnbind:function(e,n,r){var i=f[n];if(i)if(r){if(i=i[e]){var s=t.identify(r);if(s in i.uniqIds){var o=i.uniqIds[s],u=i.fns.length-1;i.fns.splice(o,1);while(o<u)i.uniqIds[i.fns[o++].uniqId]=o-1;delete i.uniqIds[s]}}}else delete i[e];return this},_liveClassTrigger:function(e){var n=f[e.type];if(n){var r=e.target,i=[];for(var s in n)n.hasOwnProperty(s)&&i.push(s);do{var o=" "+r.className+" ",u=0;while(s=i[u++])if(o.indexOf(" "+s+" ")>-1){var a=0,l=n[s].fns,c,h=!1;while(c=l[a++])c.fn.call(t(r),e)===!1&&(h=!0);h&&e.preventDefault();if(h||e.isPropagationStopped())return;i.splice(--u,1)}}while(i.length&&(r=r.parentNode))}},_buildLiveEventFn:function(e,n){var r=this;return function(i){var s=[r._name,((i.data||(i.data={})).domElem=t(this)).closest(r.buildSelector()),!0],o=y.apply(null,n?s.concat([e,i]):s);if(o&&!n&&e)return e.apply(o,arguments)}},liveInitOnEvent:function(e,t,n){return this.liveBindTo(e,t,n,!0)},liveBindTo:function(e,r,i,s){if(!r||t.isFunction(r))i=r,r=e,e=n;if(!e||typeof e=="string")e={elem:e};e.elemName&&(e.elem=e.elemName);var o=this;return e.elem&&e.elem.indexOf(" ")>0?(e.elem.split(" ").forEach(function(t){o._liveClassBind(m(o._name,t,e.modName,e.modVal),r,i,s)}),o):o._liveClassBind(m(o._name,e.elem,e.modName,e.modVal),r,i,s)},liveUnbindFrom:function(e,t,n){var r=this;return e.indexOf(" ")>1?(e.split(" ").forEach(function(e){r._liveClassUnbind(m(r._name,e),t,n)}),r):r._liveClassUnbind(m(r._name,e),t,n)},_liveInitOnBlockEvent:function(e,t,n,r){var i=this._name;return l[t].on(e,function(e){var t=arguments,s=e.block[r](i);n&&s.forEach(function(e){n.apply(e,t)})}),this},liveInitOnBlockEvent:function(e,t,n){return this._liveInitOnBlockEvent(e,t,n,"findBlocksOn")},liveInitOnBlockInsideEvent:function(e,t,n){return this._liveInitOnBlockEvent(e,t,n,"findBlocksOutside")},liveInitOnBlockInit:function(e,t){return this.liveInitOnBlockEvent("init",e,t)},liveInitOnBlockInsideInit:function(e,t){return this.liveInitOnBlockInsideEvent("init",e,t)},on:function(e,t,n,r,i){return e.jquery?this._liveCtxBind(e,t,n,r,i):this.__base(e,t,n,r)},un:function(e,t,n,r){return e.jquery?this._liveCtxUnbind(e,t,n,r):this.__base(e,t,n)},liveCtxBind:function(e,t,n,r,i){return this._liveCtxBind(e,t,n,r,i)},_liveCtxBind:function(e,r,i,s,o){var u=this;if(typeof r=="string"){t.isFunction(i)&&(o=s,s=i,i=n);if(r.indexOf(" ")>-1)r.split(" ").forEach(function(t){u._liveCtxBind(e,t,i,s,o)});else{var f=u._buildCtxEventName(r),l=a[f]||(a[f]={counter:0,ctxs:{}});e.each(function(){var e=t.identify(this),n=l.ctxs[e];n||(n=l.ctxs[e]={},++l.counter),n[t.identify(s)+(o?t.identify(o):"")]={fn:s,data:i,ctx:o}})}}else t.each(r,function(t,n){u._liveCtxBind(e,t,n,i)});return u},liveCtxUnbind:function(e,t,n,r){return this._liveCtxUnbind(e,t,n,r)},_liveCtxUnbind:function(e,n,r,i){var s=this,o=a[n=s._buildCtxEventName(n)];return o&&(e.each(function(){var e=t.identify(this,!0),n;if(e&&(n=o.ctxs[e])){r&&delete n[t.identify(r)+(i?t.identify(i):"")];if(!r||t.isEmptyObject(n))o.counter--,delete o.ctxs[e]}}),o.counter||delete a[n]),s},_extractElemNameFrom:function(e){if(e.__bemElemName)return e.__bemElemName;var t=e[0].className.match(this._buildElemNameRE());return t?t[1]:n},extractParams:S,_buildModClassPrefix:function(e,t){return m(this._name)+(t?d+(typeof t=="string"?t:this._extractElemNameFrom(t)):"")+p+e+p},_buildModValRE:function(e,t,n){return new RegExp("(\\s?)"+this._buildModClassPrefix(e,t)+"("+h+")(\\s|$)",n)},_buildElemNameRE:function(){return new RegExp(this._name+d+"("+h+")(?:\\s|$)")},buildSelector:function(e,t,n){return"."+m(this._name,e,t,n)},getBlockByUniqId:function(e){return o[e]},getWindowSize:function(){return{width:r.width(),height:r.height()}}})}(BEM,jQuery),function(){String.prototype.trim||(String.prototype.trim=function(){var e=this.replace(/^\s\s*/,""),t=/\s/,n=e.length;while(t.test(e.charAt(--n)));return e.slice(0,n+1)})}(),$(function(){BEM.DOM.init()}),function(e,t){var n=e.jQuery||e.Cowboy||(e.Cowboy={}),r;n.throttle=r=function(e,r,i,s){function a(){function p(){u=+(new Date),i.apply(n,l)}function v(){o=t}var n=this,a=+(new Date)-u,l=arguments;s&&!o&&p(),o&&clearTimeout(o),s===t&&a>e?p():r!==!0&&(o=setTimeout(s?v:p,s===t?e-a:e))}var o,u=0;return typeof r!="boolean"&&(s=i,i=r,r=t),n.guid&&(a.guid=i.guid=i.guid||n.guid++),a},n.debounce=function(e,n,i){return i===t?r(e,n,!1):r(e,i,n!==!1)}}(this),BEM.DOM.decl("space-switcher",{onSetMod:{js:function(){var e=this;e._popup=e.findElem("popup"),e._filter=e.findBlockInside("space-switcher-filter"),e._popupHeightHandler(),e.bindToWin("click",e._onOutsideClick)},active:{yes:function(){var e=this,t=e._getPopup(),n=e._getFilter();$.when(n.loadData()).then(function(){e.toggleMod(t,"visible","yes"),n.focus()})},"":function(){var e=this,t=e._getPopup(),n=e._getFilter();e.toggleMod(t,"visible","yes"),n.blur()}}},_popup:null,_filter:null,_isActive:function(){return this.hasMod("active")},_toggleActivity:function(){this.toggleMod("active","yes")},_popupHeightHandler:function(){this.setPopupHeight(),this.bindToWin("resize",$.throttle(100,this.setPopupHeight))},_getPopup:function(){return this._popup},_getFilter:function(){return this._filter},_onOutsideClick:function(e){var t=$(e.target);!this.containsDomElem(t)&&this._isActive()&&this.delMod("active")},setPopupHeight:function(){var e=this._getPopup(),t=e.height(),n=this.findBlockInside("space-switcher-filter"),r=n.findElem("spaces"),i=n.findElem("spaces-inner"),s=n.findElem("input"),o=s.outerHeight(!0),u=i.outerHeight(!0),a=u+o,f=$(window).height(),l=f*.8-40;(t>l||a!==t)&&r.css({height:l-o<a?l-o:u})}},{live:function(){this.liveBindTo("control","click",function(){this._toggleActivity()})}}),BEM.DOM.decl("space-switcher-filter",{onSetMod:{js:function(){var e=this,t=e.findElem("spaces-inner");$.when(e.loadData()).then(function(){var n=e._getData(),r=BEM.blocks.organization._build(n),i=BEMHTML.apply(r);t.append(i),e._initFields(),e._bindToMouseEvents()})},focused:{yes:function(){var e=this._getInput();e.focus(),this.bindTo("keypress",function(e){this._onKeyPress(e)}).bindTo("keydown",function(e){this._onKeyDown(e)}).bindTo("keyup",function(e){this._onKeyUp(e)})},"":function(){this.unbindFrom("keypress keydown keyup")}}},onElemSetMod:{item:{matched:{yes:function(e){e.html(this._highlight(e.text()))},"":function(e){var t=e.html().replace("<strong>","").replace("</strong>","");e.html(t)}}}},_data:null,_items:null,_navItems:null,_input:null,_organizations:null,_spaceSwitcher:null,_curItemIndex:-1,_rowHeight:23,_query:"",_initFields:function(){this._items=this.findElem("item"),this._navItems=this._items,this._input=this.findElem("input"),this._organizations=this.findBlocksInside("organization"),this._spaceSwitcher=this.findBlockOutside("space-switcher"),this._rowHeight=this._getRowHeight(),this._curItemIndex=0},_bindToMouseEvents:function(){var e=this,t=e._getItems();e.bindTo(t,{mouseover:function(t){e._onEnterItem(t.data.domElem)},mouseout:function(t){e._onLeaveItem(t.data.domElem)}})},_onEnterItem:function(e,t){var n=this._curItemIndex,r=this._getNavItems();n>-1&&this.delMod(r.eq(n),"state"),n=this._getItemIndex(e),n>-1&&this.setMod(r.eq(this._curItemIndex=n),"state","selected"),t&&this._scrollToCurrent()},_onLeaveItem:function(e){var t=this._curItemIndex,n=this._getNavItems();t>-1&&t===this._getItemIndex(e)&&(this.delMod(n.eq(t),"state"),this._curItemIndex=-1)},_getItems:function(){return this._items},_getNavItems:function(){return this._navItems},_updateNavItems:function(){var e=this,t=e._getOrganizations(),n=e._getItems(),r=[];t.forEach(function(t){var i=$(t.domElem);t.hasMod("hidden","yes")?r=e.findElem(i,"item"):r=e.findElem(i,"item","hidden","yes"),n=n.not(r)}),this._navItems=n},_getInput:function(){return this._input},_getOrganizations:function(){return this._organizations},_getSpaceSwitcher:function(){return this._spaceSwitcher},_getRowHeight:function(){var e=this._getItems();return e.outerHeight()},_getItemIndex:function(e){var t=this._getNavItems();return $.inArray(e.get(0),t)},_onKeyPress:function(e){var t=this._getNavItems();e.keyCode===13&&(e.preventDefault(),this._curItemIndex>-1&&this._onSelectItem(t.eq(this._curItemIndex)))},_onKeyDown:function(e){var t=this._getNavItems();if(e.keyCode===38||e.keyCode===40){e.preventDefault();var n=t.length;if(n){var r=e.keyCode-39,i=this._curItemIndex,s=0;do i+=r;while(i>=0&&i<n&&this._onEnterItem(t.eq(i),!0)===!1&&++s<n)}}},_onKeyUp:function(e){var t=[9,13,16,17,18,27,38,40];~$.inArray(e.keyCode,t)||this._lookup()},_lookup:function(){var e=this._getInput();this._query=e.val(),this._process()},_process:function(){var e=this,t=e._getItems().toArray();t=$.grep(t,function(t){return e._matcher(t)}),e._render(t)},_matcher:function(e){var t=$(e),n=this._query,r=n.toLowerCase(),i=e.text.toLowerCase();return~i.indexOf(r)&&!t.hasClass("organization__create-space")},_render:function(e){var t=this,n=t._getItems(),r=n.not(e),i=t._getSpaceSwitcher(),s=t._getOrganizations();n.each(function(e,n){var r=$(n);t.delMod(r,"hidden").delMod(r,"state").delMod(r,"matched")}),r.each(function(e,n){var r=$(n);!r.hasClass("organization__name")&&!r.hasClass("organization__create-space")&&t.setMod(r,"hidden","yes")}),e.forEach(function(e){var n=$(e);this._query!==""&&t.setMod(n,"matched","yes")}),s.forEach(function(e){var n=e.findElem("name"),r=e.findBlockInside("list"),i=r.findElem("item"),s=i.length,o=0;i.each(function(e,n){var r=$(n);t.hasMod(r,"hidden","yes")&&o++}),s===o+2?t.hasMod(n,"matched","yes")||e.setMod("hidden","yes"):e.delMod("hidden")}),t._updateNavItems(),t._onEnterItem(t._getNavItems().eq(0)),i.setPopupHeight(),t._scrollToCurrent()},_highlight:function(e){var t=this._query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},_onSelectItem:function(e){window.location.href=e.attr("href")},_scrollToCurrent:function(){if(this._curItemIndex<0)return;var e=this.findElem("item","state","selected").get(0).offsetTop,t=this.findElem("spaces"),n=t.scrollTop(),r=e-n,i=this._rowHeight*2,s;r>t.height()-i?s=e-i:n&&r<i&&(s=e-t.height()+i),s&&t.scrollTop(s)},_getData:function(){return this._data},focus:function(){return this.setMod("focused","yes")},blur:function(){return this.delMod("focused")},loadData:function(){var e=this,t=$.Deferred();return e._data?t.resolve():$.ajax({url:"http://maxcold.github.io/podio-puzzle/production/data.json",dataType:"json",success:function(n){e._data=n,t.resolve()},error:function(){t.reject()}}),t.promise()}}),BEM.DOM.decl("organization",{},{_build:function(e){return e.map(function(e,t){var n=e.spaces||[],r=e.image&&e.image.thumbnail_link||"",i=e.name||"",s=e.url||"";return{block:"organization",content:[{elem:"icon",src:r},{block:"list",js:!0,content:[{elem:"item",mix:[{block:"organization",elem:"name"},{block:"space-switcher-filter",elem:"item",elemMods:t===0?{state:"selected"}:{}}],url:s,content:i},n.map(function(e){var t=e.name||"",n=e.url||"";return{elem:"item",mix:[{block:"space-switcher-filter",elem:"item"}],url:n,content:t}}),{elem:"item",mix:[{block:"organization",elem:"create-space"},{block:"space-switcher-filter",elem:"item"}],url:"#create",content:"+ New space"}]}]}})}})
